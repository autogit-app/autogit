# PKGBUILD for AutoGit - packages pre-built Flutter Linux bundle.
# In CI, the linux-bundle artifact is placed in ./bundle/ before running makepkg.
pkgname=autogit
pkgver=@VERSION@
pkgrel=1
pkgdesc='Flutter app for managing local and remote Git repositories with GitHub'
arch=('x86_64')
url='https://github.com/autogit-app/autogit'
license=('MIT')
depends=('gtk3' 'libglvnd' 'openssl')
source=()
sha256sums=()

prepare() {
  # Bundle is provided by CI (downloaded artifact) at ./bundle/
  return 0
}

build() {
  return 0
}

package() {
  mkdir -p "$pkgdir/usr/lib/autogit"
  cp -r bundle/* "$pkgdir/usr/lib/autogit/"
  mkdir -p "$pkgdir/usr/bin"
  ln -s /usr/lib/autogit/autogit "$pkgdir/usr/bin/autogit"
  mkdir -p "$pkgdir/usr/share/applications"
  cat > "$pkgdir/usr/share/applications/org.autogit.Autogit.desktop" << 'EOF'
[Desktop Entry]
Name=AutoGit
Comment=Manage Git repos and GitHub
Exec=/usr/lib/autogit/autogit
Icon=org.autogit.Autogit
Type=Application
Categories=Development;RevisionControl;
EOF
}
